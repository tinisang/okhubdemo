import { Header } from "./Header/Header";
import { Footer } from "./Footer/Footer";
import Head from "next/head";
import { useRouter } from "next/router";
import { useEffect, useState } from "react";

import { motion, AnimatePresence } from "framer-motion"

import ScrollTrigger from "gsap/dist/ScrollTrigger";
import loadingImage from '../public/imgs/loading.svg'
import Image from "next/image";


export const Base = (props) => {
  // console.log(props)
  const [loading, isLoading] = useState(false)
  const router = useRouter()

  useEffect(()=>{

    ScrollTrigger.refresh()
    router.events.on('routeChangeStart', (url, { shallow }) => {
      isLoading(true)
    });
    router.events.on('routeChangeComplete', (url, { shallow }) => {
      isLoading(false)
    });
    
  },[])
  
  return (
    <>

    
    <Head>
      <title>OKHUB</title>
      <meta name="description" content="Generated by create next app" />
      <link rel="icon" href="/imgs/logo.svg" />
    </Head>
    
      
      <Header/>
      <AnimatePresence exitBeforeEnter initial={false}>

      {
        loading && (
        <motion.div 
        key={'loading-section'}
        className="loading-section"
        initial={{opacity:0}}
        animate={{opacity:1}}
        exit={{opacity:0}}

        >
          <Image src={loadingImage} alt='' />
        </motion.div>

        )
      }
      </AnimatePresence>
 
        {props.children}
       
      <Footer/>
 
    </>
  );
};
